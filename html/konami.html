<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Konami Code</title>
    <!-- Bootstrap 5.1.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body class="container-lg text-center p-3">
<div class="jumbotron bg-warning">
    <h1 class="text-center fw-bold text-uppercase p-3">Konami Code</h1>
    <p class="text-center ">Press the correct sequence of keys to activate cheat!</p>
    <button type="button" class="btn btn-primary mb-3 hint">Spoiler Button</button>
</div>
<div class="container-fluid align-items-center hint-container">
</div>
<div class="card border-warning border-3 mt-3 update-color">
    <h3 class="card-header border-warning border-3 hidden-on-success">Key Codes</h3>
    <div class="card m-3 border-warning border-3 konami">
        <ul class="list-group text-uppercase text-center hidden-on-success">
            <li class="list-group-item">up = 38</li>
            <li class="list-group-item">down = 40</li>
            <li class="list-group-item">left = 37</li>
            <li class="list-group-item">right = 39</li>
            <li class="list-group-item">a = 65</li>
            <li class="list-group-item">b = 66</li>
        </ul>
    </div>
</div>
<!-- Bootstrap 5.1.3 JS w/ Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
<!-- jQuery 2.2.4 -->
<script src="../js/jquery-2.2.4.js"></script>
<!-- jQuery Scripts-->
<script>
    "use strict";
    // https://keycode.info/

    // Store keycodes as an array: compare counter w/ length to indicate the end of the code.
    // Use indexof(keyPressed) to check if each keypress matches
    const cheatArray = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65];

    // The function looks for the first key (38/up) to start the sequence
    let beginning = false;
    // Counter: code execution stops when counter == cheatArray.length
    let counter = 0;

    // Need a way to restart if the user enters the wrong sequence
    let restart = function () {
        beginning = false;
        counter = 0;
    }

    $(document).keyup(function (event) {
        // Logs numerical value of key pressed (for reference)
        console.log(event.keyCode);
        // Stores the last key pressed
        let keyPressed = event.keyCode;

        // Look for the beginning key to equal up/38:
        if (!beginning) {
            if (keyPressed === 38) {
                beginning = true;
            }
        }
        // Sequence has started
        if (beginning) {
            // Incorrect sequence
            if (keyPressed !== cheatArray[counter]) {
                // Error change bg to red for 1 sec
                // $('.error').css('background-color','#F00').delay(1000).queue(function(){
                //     $(this).css("background", "#FFF").dequeue();
                // });
                restart();
            } else {
                // Correct key in the sequence was entered, increase counter (which also moves to the next index of the array)
                counter++;
            }
            // Keys have been pressed in the correct sequence, and stops when the array length is reached.
            if (cheatArray.length === counter) {
                // Changes jumbotron to green
                $('.jumbotron').removeClass('bg-warning').addClass('bg-success');
                // Adds contra wallpaper
                $('.konami').prepend('<img src="../assets/img/contra.png" id="hint-image" class="img-fluid" alt=""/>').css('background-color', '#000')
                // Removes li, card heading
                $('.hidden-on-success').addClass('d-none');
                // Changes bg-color of card
                $('.update-color').addClass('bg-success');
            }
        }
    });
    // Hint Button: Inserting img tag (every time you click it inserts another img)
    $('.hint').click(function () {
        $('.hint-container').prepend('<img src="../assets/img/Konami-code.png" id="hint-image" class="img-fluid" alt=""/>').css('background-color', '#000');
    });

    // Could also have the image in the html, with d-none and then toggle
    // Or use the toggle with a callback that .prepend or .remove
    // $('.hint').click(function () {
    //     $('.hint-container').toggle(function(){
    //         $('.hint-container').prepend('<img src="../assets/img/Konami-code.png" id="hint-image" class="img-fluid" alt=""/>').css('background-color', '#000')});
    // });

    // Hint Button: Changing background-image of div - couldn't get it centered
    /*    $('.hint').click(function () {
            $('#hint-image').css({
                'background-image': 'url(../assets/img/Konami-code.png)',
                'background-repeat': 'no-repeat'
            }).height('90px');
        })*/
</script>
</body>
</html>